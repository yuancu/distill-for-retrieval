# Quick test configuration for fast experimentation
# Reduced epochs and samples for quick testing

# Query instruction for retrieval
query_instruction: "Instruct: Given a web search query, retrieve relevant passages that answer the query\nQuery: "

# Model configuration
model:
  teacher: "infly/inf-retriever-v1"
  student: "sentence-transformers/all-mpnet-base-v2"
  teacher_dim: 3584
  student_dim: 768
  projection_hidden_dim: 1536
  use_projection: false

# Phase 1: Quick test with minimal data
phase1:
  # Pre-computed embeddings (required for faster training)
  # Format: {base_dir}/{dataset_name}_{precision}/
  # Example: ./cache/embedding/msmarco_fp16/
  precomputed_embeddings_dir: "./cache/embedding/"

  # Dataset configuration - minimal samples for quick testing
  datasets:
    - name: "msmarco"
      max_samples: 1000  # Very small for quick testing

  # Training hyperparameters
  batch_size: 64
  learning_rate: 2.0e-5
  warmup_steps: 100
  num_epochs: 1
  mse_weight: 0.4
  cosine_weight: 0.6
  max_length: 512
  gradient_accumulation_steps: 4

# Phase 2: Quick test
phase2:
  # Pre-computed embeddings (required for faster training)
  # Format: {base_dir}/{dataset_name}_{precision}/
  # Example: ./cache/embedding/msmarco_fp16/
  precomputed_embeddings_dir: "./cache/embedding/"

  # Dataset configuration - minimal for quick testing
  datasets:
    - name: "msmarco"
      max_samples: 1000  # Very small for quick testing

  # Training hyperparameters
  batch_size: 16
  learning_rate: 5.0e-6
  warmup_steps: 50
  num_epochs: 1  # Single epoch for quick test
  infonce_weight: 0.8
  mse_weight: 0.2
  temperature: 0.02
  max_length: 512
  num_negatives: 7
  gradient_accumulation_steps: 8

# Training control
training:
  skip_phase1: false
  skip_phase2: false
  save_to_artifacts: true  # Save for testing

# Output paths
paths:
  output_dir: "./checkpoints"
  artifacts_dir: "./artifacts"
